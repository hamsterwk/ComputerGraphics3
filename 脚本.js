'use strict';

var 表格;
var 语言;

function 弹出表格(事件) {
    表格.省 = 事件.currentTarget.省;
    表格.getElementsByTagName('th')[0].textContent = 省名(表格.省);
    表格.style.display = 'table';
    表格.style.left = 事件.clientX + 'px';
    表格.style.top = 事件.clientY + 'px';
    事件.stopPropagation();
}

function 处理选择(事件) {
    var 选择 = +事件.currentTarget.getAttribute('data-级别');
    表格.省.等级 = 选择;
    表格.省.图形.attr({fill : 颜色[选择]});
    document.getElementById('等级').textContent = 计算();
    表格.style.display = 'none';
}

var 中国 = {
	医学部 : {
        名称 : {zh : '医学部', en : '医学部'},
        路径 : 'M129.3,129.71l10.09,7.57,4,18.29,39.94-10.25-5.05-32.64,117.1-15.55,3.78,16.81,31.74,66.22-29.22,52.77h-2.94l-39.94-4-15.56-2.53L201,216.74,189.64,213l-20.19-3.58-15.55-1.89-15.14-2.31L77,188.57l45.62-57Z',
		偏移 : {x : 0, y : 0},
	},
	工学部 : {
        名称 : {zh : '工学部', en : '工学部'},
        路径 : 'M475.49,223.5c10.93-4.06,17.75-3,22.07,1.26l56.34,29L555,314.94l-11.77,9.88V349l-12.61,8.2-18.29-2.32-37-9-40.58-.63-63.9,27.33s-14.09,2.95-14.72,3.57-3.78-12-3.78-12l-41.21,12-1-3.57-22.7,9.25-15.77-.21-39.52,10.09L197.58,382V362l17-2.52c6.71.19,9.54-3.42,8.62-10.72L222.17,324c-1.13-5.27,1.26-8.88,9.67-9.67l33.64-1.05c3.79.32,5-1.78,4-6.1-2.51-11.67-3.73-22.86-2.1-33-.6-8.55,3.21-11.52,8.83-12.19l74.21-5.47,3.57-5.89-2.31-16.81c.46-5.68,2.22-10.36,10.09-10.3C404.46,238.87,443.62,242.88,475.49,223.5Z',
		偏移 : {x : -70, y : 20},
	},
	湖滨 : {
        名称 : {zh : '湖滨', en : '湖滨'},
        路径 : 'M605.4,277.73c38.51,13.1,58.12,27.78,62.65,43.73l8.2,39.73L624.53,379.9l-5.46-15.77-24,5.89-51.92-21V324.82L555,314.94l-1.05-61.17Z',
		偏移 : {x : 0, y : 0},
	},
	文理学部 : {
        名称 : {zh : '文理学部', en : '文理学部'},
        路径 : 'M271.57,381.58l15.77.21,22.7-9.25,1,3.57,41.21-12,3.78,12,14.72-3.57,63.9-27.33,39.74.62,56.13,11.37,12.61-8.2,51.92,21,24-5.89,5.46,15.77,51.72-18.71c4.07,23.23,10.62,42.67,21.65,55.29,27.05,21.22,48.67,43,60.33,65.8,3.71,10.34,3.59,18.32,0,24.17l-14.92,7.78,2.1,32.59-2.31,23.12-22.28-1.89-8.41-12.62-10.3-9.25-12.41,6.94,1.68,3.79-8,5.88H673.31l-1.27-2.1L638.62,579.4l-7.15-1.68-42.25,5.46,2.94,27.33-9,36-37.63-9L547,624.6l-23.54-1.68c-4-10.71-11.89-5.95-10.93,2.52l-8.62,3.78L458,616.61,326,560.27c-12.82,12.12-21.13,16.69-21.65,8.2,6.66-15.63,1-24.8-13.88-29.22q-13,3.57-5.88-30.69c4-9.83,1.52-20.69-4.84-32.17l-47.72-84.72Z',
		偏移 : {x : 0, y : 100},
	},
	信息学部 : {
        名称 : {zh : '信息学部', en : '信息学部'},
        路径 : 'M326,560.27l132,56.34-6.52,24.17,6.52,4.63,1,23.33H448.58v39.1l-6.1,17.66-.21,11.36-18.92,34L400,772.11l-9,2.58L262.11,731c-9.15-1.81-13.89-6.79-15.13-14.3v-24.8l7.78.21V650.87l24.17-2.73,2.31,24.6,20.18.63-2.52-18.71-2.1-1-4.62-14.51L285,626.7l8.83-8-5.26-4,13-11.57L288,587.39Z',
		偏移 : {x : -20, y : -60},
	},
	信息学部操场 : {
        名称 : {zh : '信息学部操场', en : '信息学部操场'},
        路径 : 'M404.9,675.25v33.64c-7.24,6.3-14.47,5.9-21.68,0V675.63Q394.06,666.15,404.9,675.25Z',
		偏移 : {x : 10, y : 0},
	},
	青楼 : {
        名称 : {zh : '青楼', en : '青楼'},
        路径 : 'M429.07,721.73l-.38,19.46-18.32.25-.06-6.1,11.7.89v-9.92l-44.51.63v27.6H359.69V721.73Z',
		偏移 : {x : 0, y : 0},
	},
	信部一食堂 : {
        名称 : {zh : '信部一食堂', en : '信部一食堂'},
        路径 : 'M355.69,669.77,355.08,680H340.41V669.77Z',
		偏移 : {x : 0, y : 10},
	},
	信部二食堂 : {
        名称 : {zh : '信部二食堂', en : '信部二食堂'},
        路径 : 'M337.66,694.53v7.33l-3.67.92.3,4.28,3.37-.46v8.71H318.25v-8.86h4v-4.28h-4v-7.64Z',
		偏移 : {x : -38, y : 0},
	},
	网安操场 : {
        名称 : {zh : '网安操场', en : '网安操场'},
        路径 : 'M275.76,658.92v26.74q-8.79,11.93-17.58,0V659.53Q267,649.43,275.76,658.92Z',
		偏移 : {x : 0, y : 0},
	},
	信息学部图书馆 : {
        名称 : {zh : '信息学部图书馆', en : '信息学部图书馆'},
        路径 : 'M404.9,646.46v13.37H382.59V646.46Z',
		偏移 : {x : 10, y : 12},
	},
	大活 : {
        名称 : {zh : '大活', en : '大活'},
        路径 : 'M413.62,700h15.45v14.06H413.62V700Z',
		偏移 : {x : 0, y : 0},
	},
	星湖园食堂 : {
        名称 : {zh : '星湖园食堂', en : '星湖园食堂'},
        路径 : 'M384.73,613.37v9H371.59v-9Z',
		偏移 : {x : 0, y : 10},
	},
	银泰创意城 : {
        名称 : {zh : '银泰创意城', en : '银泰创意城'},
        路径 : 'M267.66,714.24h41.57l-1.83,29.19-36.84-14.06,1.07-3.36L263.38,723l2-5.19Z',
		偏移 : {x : 0, y : 0},
	},
	武大正门 : {
        名称 : {zh : '武大正门', en : '武大正门'},
        路径 : 'M304,534.47c4.83,2.55,9.55,1.38,14.17-2.89,9.35-5,17.21-6.15,23-2,4.81,11.05-4.37,19.9-16.05,28.34l-25.45-20.67Z',
		偏移 : {x : 0, y : 0},
	},
	总图书馆 : {
        名称 : {zh : '总图书馆', en : '总图书馆'},
        路径 : 'M426.58,474.9l.87-3.62,14.61,3.33.86-2.17,8.1,2.46-3.33,10.7-2.31-.58-1.44,4.34L451,491l-3.33,11.86-7.08-2.32-4.05,15-7.81-2.17.87-5.64-14-3.47,3.76-16.63h1.41l3.36-13.44Z',
		偏移 : {x : 0, y : 0},
	},
	教五 : {
        名称 : {zh : '教五', en : '教五'},
        路径 : 'M397.23,465.21l1.45-6.94,4.48,1.3-1.59,6.51,10.27,1.66-.87,4.41L385.52,467l.87-3.62Z',
		偏移 : {x : -20, y : -5},
	},
	教四 : {
        名称 : {zh : '教四', en : '教四'},
        路径 : 'M406.92,450.32l1.45.29.14-1.74-2.6-1.44,1.3-1.88,2.53,1.15v-1.15l1.08-.29L409.74,443l3.4-1.88,3.9,3.18v3.47l-1.44,1-2-1-1.73,1,1.73,3.18-1.73,1.3-3.47-1.3-1.45.87,1.3,1,1.16,3.18-1.59,1.3-4.2-1.15-1.15-2.75Z',
		偏移 : {x : -8, y : -8},
	},
	珞珈广场 : {
        名称 : {zh : '珞珈广场', en : '珞珈广场'},
        路径 : 'M357.62,519.14l7.66-10.26,11.57-37.6,35,7.38-9.4,46.12-3,2.27c-.16.58-1.33.36-2.89,2.07l-3,5.06-14.74-3.9c-5.24,0-8.42,1.25-9.84,3.61l-7.66,9.69-16.77-13.3Z',
		偏移 : {x : 0, y : 0},
	},
	万林艺术馆 : {
        名称 : {zh : '万林艺术馆', en : '万林艺术馆'},
        路径 : 'M426.87,440.05l9,4.34,2.6,4.05-4.19,10.84-14.17-1.73,4.19-16.48Z',
		偏移 : {x : 35, y : 0},
	},
	桂园操场 : {
        名称 : {zh : '桂园操场', en : '桂园操场'},
        路径 : 'M369,402l1.15,1c5.3-2.8,10.42-2.4,15.33,1.59l1-.43,5.21,32.24-2,.43c-3.55,7.14-9.74,7.94-18.65,2.17l-6.65-36Z',
		偏移 : {x : 0, y : 0},
	},
	桂园食堂 : {
        名称 : {zh : '桂园食堂', en : '桂园食堂'},
        路径 : 'M349.23,406.22v4.92l-4.77,1,1.15,5.64h-1.15l1.15,4.91-3.47.73-.86-4.92H339.4l-1.74-10Z',
		偏移 : {x : -25, y : 0},
	},
	梅园食堂 : {
        名称 : {zh : '梅园食堂', en : '梅园食堂'},
        路径 : 'M464.61,487.48l1.45-3h1.15l.29,1.59,1.88-1.59,1.74,1L468.23,491l.72,1.23-1,1.16H466.2l-.87,1.73-4.33-2.6,1.88-5.64Z',
		偏移 : {x : 5, y : -20},
	},
	梅园操场 : {
        名称 : {zh : '梅园操场', en : '梅园操场'},
        路径 : 'M480.81,395.66l4.62,10.27L460,418.65,456.23,409Z',
		偏移 : {x : 0, y : 15},
	},
	樱顶 : {
        名称 : {zh : '樱顶', en : '樱顶'},
        路径 : 'M472,352.87l4.19,15-50.61,12-2.31-13.15Z',
		偏移 : {x : 0, y : 0},
	},
	樱花大道 : {
        名称 : {zh : '樱花大道', en : '樱花大道'},
        路径 : 'M419.07,425.16V391l16.33-.87,4.34-2,35.72-9.69,28.34-4.34,4.48-1v2.31l-9.69,3.47Z',
		偏移 : {x : -20, y : 0},
	},
	九一二操场 : {
        名称 : {zh : '九一二操场', en : '九一二操场'},
        路径 : 'M498.16,386.12l5.93,33.26H506c7.58,4.71,13.38,3.35,17.64-3.18l1.88-.44-5.63-32.68-2.46.73c-6.23-5-11.47-3.39-16.2,1.73Z',
		偏移 : {x : 40, y : 0},
	},
	理学楼 : {
        名称 : {zh : '理学楼', en : '理学楼'},
        路径 : 'M497.89,365.8l1.2-1.51-.13-1-.9.15-.1-1.87,4.31-.51.08,1.77h-.72l0,1.12,1.56.95,8.34-1.23.2,2.34-7.95,1.18-1,1.3V370l-3.1.16v-1.05l-1.56-1-8.39,1.12-.23-2.23Z',
		偏移 : {x : 0, y : -5},
	},
	珞珈山 : {
        名称 : {zh : '珞珈山', en : '珞珈山'},
        路径 : 'M485.83,479.7l-6.67,12.64-3.51,1.07-3.34-1.59-6.25,7.72L452,510.6q-4,2.45-3.86,9.83l1.22,8.08L456,526.4l6.14,4.92,1.05,2.45,7,6,43.71,15.8,1.05-2.8,9.66.7.88-1.06v-2.63c3.89.65,6.63,2.56,9.3,2.81l6.5-.7c.51-3.07,2.86-3.57,7.37-1.06l13.87-1.4,6.5,4.56,58.64-7.9,14-6.14,2.11,1.58,6.49-2.46a34.28,34.28,0,0,0,18.61-12.81l5.62-1.76,7,17.56,43.89-21.77c12.83-10.05,12.44-20.74,4.57-31.78-3.92-5.88-15.82-12.35-29.85-19,1.34-8.55-2.06-12.81-8.6-14.22-3.69.46-6.92,0-8.78-3.34l-1.93-5.09-48.81,6.67,1.41,6-8.25,9.83-9.48,4.39-31.25,5.8c-4.35,0-6.15-1.29-3.86-4.57l-.53-2.28-6-1.41c-1.55-.6-2.46,1.37-3,4.92l-7.37.88-1,1.75-24.05-.52-3.87-8.08c-2-4.37-4.31-7.85-8.25-7.72-.21,3.55-1.3,6.17-4.39,6.67l-18.61.88Z',
		偏移 : {x : 0, y : 0},
	},
	枫园食堂 : {
        名称 : {zh : '枫园食堂', en : '枫园食堂'},
        路径 : 'M629.81,440l-.88-6.67L644,432l.38,4.92h-.64l.64,6.68-2.57.05.26,1.75-10.64,1,.08,1,1.57-.23.31,3.86-5.31.48-.28-3.53,1.75-.12v-1.09l-3.19.28-.79-6.66Z',
		偏移 : {x : 0, y : -15},
	},
	枫教 : {
        名称 : {zh : '枫教', en : '枫教'},
        路径 : 'M697.76,435.86l4.79,4.79-2.78,2.62-3.25-3.55L686,441.11l.77,4.94H681.7l-.62-8.34Z',
		偏移 : {x : 0, y : -10},
	},
	湖滨食堂 : {
        名称 : {zh : '湖滨食堂', en : '湖滨食堂'},
        路径 : 'M595.37,321.73v8.65l-10.66-.77v-4.48h-2.62v-3.4Z',
		偏移 : {x : 0, y : 10},
	},
	凌波门外栈道 : {
        名称 : {zh : '凌波门外栈道', en : '凌波门外栈道'},
        路径 : 'M604.33,250.7l24.55,9.11-8.49,19-25-10,7.26-15Z',
		偏移 : {x : 0, y : -20},
	},
	工学部操场 : {
        名称 : {zh : '工学部操场', en : '工学部操场'},
        路径 : 'M548.27,261.2l3.24,27.8a6.09,6.09,0,0,1-2.32,3.08c-3.91,2.56-7.69,2.8-11.27,0-2.71-3.39-1.08-.52-3.09-5.4l-2.47-24.09C538.13,255.67,543.43,255.15,548.27,261.2Z',
		偏移 : {x : 0, y : 0},
	},
	工学部一食堂 : {
        名称 : {zh : '工学部一食堂', en : '工学部一食堂'},
        路径 : 'M501.07,277.23l1.77,11.49-12.63,2-.57-4.48,2.72-.57-1.08-6.89Z',
		偏移 : {x : 0, y : 10},
	},
	工学部二食堂 : {
        名称 : {zh : '工学部二食堂', en : '工学部二食堂'},
        路径 : 'M486.11,265.36l3-.38-.12-1,11.49-1.39.7,5.49h-.7l.95,5.69-2.91.5-.31-.76-3.73.44v1l-3.85.57-.95-6.63h-3.16Z',
		偏移 : {x : 0, y : -10},
	},
	工学部菜市场 : {
        名称 : {zh : '工学部菜市场', en : '工学部菜市场'},
        路径 : 'M300.87,355.07l.78,12.71h-5.54l-.67-12.29Z',
		偏移 : {x : 0, y : -10},
	},
	行政楼 : {
        名称 : {zh : '行政楼', en : '行政楼'},
        路径 : 'M500.76,437.24l3.11-.31.15,1.48,3.54-.28-.66-6.23,6.23-.83.82,6.31,3.37-.42-.2-2.22,3.34-.44.66,4.94-19.79,2.46Z',
		偏移 : {x : 0, y : 10},
	},
	教三楼 : {
        名称 : {zh : '教三楼', en : '教三楼'},
        路径 : 'M373.34,381.23l1.08,3.54-14.78,3.07-.76-3.07Z',
		偏移 : {x : 0, y : 10},
	},
	工学部图书馆 : {
        名称 : {zh : '工学部图书馆', en : '工学部图书馆'},
        路径 : 'M400,266.12l1.61,9.61L382,278.81,380.78,269Z',
		偏移 : {x : -40, y : 0},
	},
	工学部教四楼 : {
        名称 : {zh : '工学部教四楼', en : '工学部教四楼'},
        路径 : 'M392.54,279.6l.34,2.94-3.2.48,1.52,11.34,3.59-.6.26,2.77-10.56,1.25-.31-2.51,3.12-.48-1.17-11-3.36.47-.49-3.16Z',
		偏移 : {x : 20, y : 0},
	},
	工学部教五楼 : {
        名称 : {zh : '工学部教五楼', en : '工学部教五楼'},
        路径 : 'M444.22,272.47l.34,2.63-3.24.52,1.3,9.44,3.37-.48.52,2.77-9.59,1.25-.41-2.72,2.43-.31-1.47-9.26-2.08.22-.48-2.86Z',
		偏移 : {x : 0, y : -15},
	},
	雅各楼 : {
        名称 : {zh : '雅各楼', en : '雅各楼'},
        路径 : 'M360.36,290.16l.35,1.64,9.63-1.17v-1.94l3.29-.09.94,7.31-3.88.47v-1.76l-9.4,1.06v1.41l-3.28.69L357,290.39Z',
		偏移 : {x : -25, y : 0},
	},
	工学部十教 : {
        名称 : {zh : '工学部十教', en : '工学部十教'},
        路径 : 'M381.38,246.94l.9,8.93,6.38-.83-2.68-14,6.08-.71,3,18-16.49,2.23-1.65-12.8Z',
		偏移 : {x : 0, y : 0},
	},
	工学部教六楼 : {
        名称 : {zh : '工学部教六楼', en : '工学部教六楼'},
        路径 : 'M390.42,300.49l.78,4.11,12.72-2.23.83,3.95-16.68,2.51-1.41-7.4Z',
		偏移 : {x : 20, y : 10},
	},
	医学部操场 : {
        名称 : {zh : '医学部操场', en : '医学部操场'},
        路径 : 'M190,122.17l27.13-1.81c3.1.67,5.43,1.7,6.23,3.41,4.61,6.22,3.25,11.83-.6,17.19l-4.52,2.61L194,145.08a8.37,8.37,0,0,1-5.42-2C182.4,136.62,180.54,129.83,190,122.17Z',
		偏移 : {x : 0, y : 0},
	},
	医学部二食堂 : {
        名称 : {zh : '医学部二食堂', en : '医学部二食堂'},
        路径 : 'M259.28,106.59v10.25h-6V106.59Z',
		偏移 : {x : 0, y : 10},
	},
	医学部一食堂 : {
        名称 : {zh : '医学部一食堂', en : '医学部一食堂'},
        路径 : 'M317.66,160.45l.9,4.58h-7.13v5.47l-5.63.6v-10Z',
		偏移 : {x : 30, y : 10},
	},
	医学部一教 : {
        名称 : {zh : '医学部一教', en : '医学部一教'},
        路径 : 'M271.14,152.51l.1,4.32-4.52.3.3,6.73,10.65-.4-.1-1.2h3v5.82h-2.71v-1.3l-3.52.4v3.92l-15.07.3v-3.21l-4.72.5v1.5h-3.42v-6.53l3.42-.3V165l9.14-.66v-7.14h-5v-4.12Z',
		偏移 : {x : -10, y : -15},
	},
	医学部教四 : {
        名称 : {zh : '医学部教四', en : '医学部教四'},
        路径 : 'M229.54,187.29l18.35-.83.2,4.11-18.31.76-.24-3.8Z',
		偏移 : {x : -10, y : 10},
	},
	医学部教三 : {
        名称 : {zh : '医学部教三', en : '医学部教三'},
        路径 : 'M251.89,187.17l10.36-.12.08-2.45h2.13v8.15l-5.53.16v4.9h-5.74l.08-3.56h4.27v-2.92h-5.65v-4.16Z',
		偏移 : {x : 0, y : -13},
	},
	医学部教二 : {
        名称 : {zh : '医学部教二', en : '医学部教二'},
        路径 : 'M272.69,184.05l.08,2,11-.51v4.39h-5.3v2.89l5.3-.16v3.16H277V191.6l-4.94.2-.2-3.68h-1.58v-4.07Z',
		偏移 : {x : 10, y : 10},
	},
	医学部图书馆 : {
        名称 : {zh : '医学部图书馆', en : '医学部图书馆'},
        路径 : 'M286.57,150.74h14.65v4.59H286.57v-4.59Z',
		偏移 : {x : 30, y : -10},
	},
	卓尔体育馆 : {
        名称 : {zh : '卓尔体育馆', en : '卓尔体育馆'},
        路径 : 'M297.73,461.14l-5.81-36.46,23-3.47,4.69,37.3Z',
		偏移 : {x : 0, y : 0},
	},
	校医院 : {
        名称 : {zh : '校医院', en : '校医院'},
        路径 : 'M456.78,539l6.37,4.6-1.7,2-7.36-4.79-3.69-5.91,1.86-1.32Z',
		偏移 : {x : 0, y : 10},
	},
	游泳馆 : {
        名称 : {zh : '游泳馆', en : '游泳馆'},
        路径 : 'M314.07,648.2v12.9h-9.53V648.2Z',
		偏移 : {x : 10, y : 12},
	},
	大创 : {
        名称 : {zh : '大创', en : '大创'},
        路径 : 'M409.23,326.72v16.21L400,346.51l-2.39-13.23V328Z',
		偏移 : {x : -18, y : 0},
	},
	群光广场 : {
        名称 : {zh : '群光广场', en : '群光广场'},
        路径 : 'M253.65,736.27l25.67,9.83-6.07,15.17-25.77-9.34,6-14.33Z',
		偏移 : {x : 10, y : 0},
	},
	未来城 : {
        名称 : {zh : '未来城', en : '未来城'},
        路径 : 'M247.48,735.51,233.6,773.4l-43.51-15.57,15-37.13Z',
		偏移 : {x : 0, y : 0},
	},
	新世界百货 : {
        名称 : {zh : '新世界百货', en : '新世界百货'},
        路径 : 'M210.91,707.38l14.25-33.9,15.75,5-12.56,33.57Z',
		偏移 : {x : 0, y : 0},
	},
	武汉大学老牌楼 : {
        名称 : {zh : '武汉大学老牌楼', en : '武汉大学老牌楼'},
        路径 : 'M162,677.68l-8.6,6.93L142,671.71l8.17-6.94Z',
		偏移 : {x : 0, y : 15},
	},
	世纪广场 : {
        名称 : {zh : '世纪广场', en : '世纪广场'},
        路径 : 'M379.51,302.36l3.27,21.77L360,325.71l-2.51-20.08Z',
		偏移 : {x : -20, y : 0},
	},
	毛像 : {
        名称 : {zh : '毛像', en : '毛像'},
        路径 : 'M272.8,206.11V216h-9.56v-9.85Z',
		偏移 : {x : 0, y : 10},
	},
};

var 颜色 = ['#DDD','#cc9', '#cc3', '#9c9', '#693'];

function 省名(省) {
    return 省.名称.hasOwnProperty(语言) ? 省.名称[语言] : 省.名称.zh;
}

function 计算() {
    var 总计 = 0;
    for (var 省名 in 中国) {
        总计 += 中国[省名].等级;
    }
    return 总计;
}

function gtag() {
    dataLayer.push(arguments);
}


function dealChange(){
	name = document.getElementById('inputName').value;
	if(name===""){
		name="我";
		document.getElementById('inputName').value=name;
	}
	document.getElementById('userName').innerHTML=name;
}
window.onload = function () {

    语言 = document.getElementsByTagName('html')[0].getAttribute('lang');
    if (语言 === null || 语言 === '') {
        语言 = 'zh';
    }

    表格 = document.getElementById('表格');
    var 地图 = new Raphael('地图');
    for (var 键 in 中国) {
        var 省 = 中国[键];
        var 图形 = 地图.path(省.路径);
        图形.attr({fill : 颜色[0]});
        省.图形 = 图形;
        省.等级 = 0;

        var x = 图形.getBBox().x + 图形.getBBox().width / 2 + 省.偏移.x;
        var y = 图形.getBBox().y + 图形.getBBox().height / 2 + 省.偏移.y;
        var 文字 = 地图.text(x, y, 省名(省));

        [图形, 文字].forEach(
            function (元素) {
                元素.attr({cursor : 'pointer'});
                元素[0].onclick = 弹出表格;
                元素[0].省 = 省;
            }
        );
    }

    Array.from(document.getElementsByClassName('选择')).forEach(
        function (选择) {
            选择.style.backgroundColor = 颜色[选择.getAttribute('data-级别')];
            选择.onclick = 处理选择;
        }
    );

    document.getElementsByTagName('html')[0].onclick = function () {
        表格.style.display = 'none';
    };

    document.getElementById('btn1').onclick = function () {
        html2canvas(document.getElementById('地图')).then(
            function (画布) {
                var image = document.getElementById('finalImg');
				var canvas = document.getElementById('地图');
				var text = document.getElementById('btn1').innerHTML;
				if(text=='产生图片'){
					image.src = 画布.toDataURL();
					image.download = document.getElementById('inputName')+'的武大探索等级.png';
					image.style.visibility='visible';
					canvas.style.visibility='hidden';
					document.getElementById('hint').innerHTML="图片已生成！长按或右键即可保存！";
					document.getElementById('btn1').innerHTML="重新生成";
				}else{
					image.src = 画布.toDataURL();
					image.style.visibility='hidden';
					canvas.style.visibility='visible';
					document.getElementById('hint').innerHTML="请输入你的名字，然后填充下方地图，最后生成图片！";
					document.getElementById('btn1').innerHTML="产生图片";
				}
                //link.download = document.getElementById('inputName').value+'的武大探索地图.png';

            }
        )
    };
};


